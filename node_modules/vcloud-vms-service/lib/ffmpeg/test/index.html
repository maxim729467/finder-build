<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FFmpeg test</title>
    <style>
        body {
            margin: 10px;
            background-color: silver;
        }

        #controls {
            display: flex;
        }

        .btn {
            padding: 10px 20px;
            margin-right: 5px;
            background-color: #000;
            color: #fff;
            user-select: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="controls">
        <div class="btn" onclick="handleStart()">Start FFmpeg</div>
        <div class="btn" onclick="handleStop()">Stop FFmpeg</div>
        <div class="btn" onclick="handleClear()">Clear Archive</div>
        <div class="btn" onclick="handleKillFmpegProcess()">Kill All Fmpeg Process</div>
    </div>

    <video width="352" height="198" controls>
        <source src="http://localhost:4440/archive/output.m3u8" type="application/x-mpegURL">
    </video>
    <script>
      const handleStart = async () => {
        const response = await fetch('http://127.0.0.1:4440/start');
        if (response.ok) {
          let json = await response.json();
          console.log(json);
        } else {
          alert("error: " + response.status);
        }
      };

      const handleStop = async () => {
        const response = await fetch('http://127.0.0.1:4440/stop');
        if (response.ok) {
          let json = await response.json();
          console.log(json);
        } else {
          alert("error: " + response.status);
        }
      };

      const handleClear = async () => {
        const response = await fetch('http://127.0.0.1:4440/clearDir');
        if (response.ok) {
          let json = await response.json();
          console.log(json);
        } else {
          alert("error: " + response.status);
        }
      };

      const handleKillFmpegProcess = async () => {
        const response = await fetch('http://127.0.0.1:4440/killAllFFmpegProcess');
        if (response.ok) {
          let json = await response.json();
          console.log(json);
        } else {
          alert("error: " + response.status);
        }
      };
    </script>
</body>
</html>
